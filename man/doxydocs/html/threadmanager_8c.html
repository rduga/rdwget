<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>RDWGET: /home/rado/workspace/rdwget/src/threadmanager.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>/home/rado/workspace/rdwget/src/threadmanager.c File Reference</h1>Simple threaded manager of files and chunks.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;pthread.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;assert.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;sys/mman.h&gt;</code><br>
<code>#include &quot;<a class="el" href="threadmanager_8h-source.html">threadmanager.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="httpclient_8h-source.html">httpclient.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="linkparser_8h-source.html">linkparser.h</a>&quot;</code><br>

<p>
<a href="threadmanager_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdowninfo.html">downinfo</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="threadmanager_8c.html#4dc78c3ac8f88f941c9aaa34a0b6ba00">run_download</a> (void *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Downloads one link (function for one thread).  <a href="#4dc78c3ac8f88f941c9aaa34a0b6ba00"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="threadmanager_8c.html#871df79560ca54f788bfca453e5ecaef">thr_mgr_downloadallfiles</a> (<a class="el" href="structprgstx.html">prgstx</a> *stx)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Downloads all links specified in <a class="el" href="structprgstx.html">prgstx</a> structure by creating thread for every link.  <a href="#871df79560ca54f788bfca453e5ecaef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="threadmanager_8c.html#526d66a9beb8ec77c0a2e6fefb0a5146">run_download_chunk</a> (void *data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="threadmanager_8c.html#c9d37685f6e984d2f0c158b4dd19a759">thr_mgr_downloadallchunks</a> (const char *resultdir, <a class="el" href="structlnk.html">lnk</a> *link, <a class="el" href="structlnk__http__header.html">lnk_http_header</a> *linkh)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function creates chunks due to link-&gt;chunknum parameter and creates one thread for every chunk and downloads the whole file into resultdir.  <a href="#c9d37685f6e984d2f0c158b4dd19a759"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="threadmanager_8c.html#74485d6eac385ad6011743cd991da981">create_chunk_bounds</a> (<a class="el" href="structchunk__bounds.html">chunk_bounds</a> **bounds, <a class="el" href="structlnk.html">lnk</a> *link, <a class="el" href="structlnk__http__header.html">lnk_http_header</a> *lnkh, <a class="el" href="defaults_8h.html#2e0f2f368d7e31e84cf87320c0954a44">file_fd</a> fd, <a class="el" href="structmaptbl.html">maptbl</a> **maptable)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates chunk bounds and maps file into memory or assignes '\0' to memory.  <a href="#74485d6eac385ad6011743cd991da981"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Simple threaded manager of files and chunks. 
<p>

<p>Definition in file <a class="el" href="threadmanager_8c-source.html">threadmanager.c</a>.</p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="74485d6eac385ad6011743cd991da981"></a><!-- doxytag: member="threadmanager.c::create_chunk_bounds" ref="74485d6eac385ad6011743cd991da981" args="(chunk_bounds **bounds, lnk *link, lnk_http_header *lnkh, file_fd fd, maptbl **maptable)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int create_chunk_bounds           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structchunk__bounds.html">chunk_bounds</a> **&nbsp;</td>
          <td class="paramname"> <em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnk.html">lnk</a> *&nbsp;</td>
          <td class="paramname"> <em>link</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnk__http__header.html">lnk_http_header</a> *&nbsp;</td>
          <td class="paramname"> <em>lnkh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="defaults_8h.html#2e0f2f368d7e31e84cf87320c0954a44">file_fd</a>&nbsp;</td>
          <td class="paramname"> <em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaptbl.html">maptbl</a> **&nbsp;</td>
          <td class="paramname"> <em>maptable</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates chunk bounds and maps file into memory or assignes '\0' to memory. 
<p>
Creates chunk bounds due to link, linkh parameters, maps file into memory and creates maptable containing list of mapping memory witch its sizes to enable use munmap after chunks will be downloaded. Mapping into memory is processed for last chunks (which have ranges at the end modulo MAX_MAP_SIZE). The first chunks will be assigned '\0' into chunk memory. <dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on fail. </dd></dl>

<p>Definition at line <a class="el" href="threadmanager_8c-source.html#l00243">243</a> of file <a class="el" href="threadmanager_8c-source.html">threadmanager.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="4dc78c3ac8f88f941c9aaa34a0b6ba00"></a><!-- doxytag: member="threadmanager.c::run_download" ref="4dc78c3ac8f88f941c9aaa34a0b6ba00" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* run_download           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Downloads one link (function for one thread). 
<p>
param data of type (<a class="el" href="structdowninfo.html">downinfo</a> *). 
<p>Definition at line <a class="el" href="threadmanager_8c-source.html#l00034">34</a> of file <a class="el" href="threadmanager_8c-source.html">threadmanager.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="526d66a9beb8ec77c0a2e6fefb0a5146"></a><!-- doxytag: member="threadmanager.c::run_download_chunk" ref="526d66a9beb8ec77c0a2e6fefb0a5146" args="(void *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* run_download_chunk           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="threadmanager_8c-source.html#l00122">122</a> of file <a class="el" href="threadmanager_8c-source.html">threadmanager.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="c9d37685f6e984d2f0c158b4dd19a759"></a><!-- doxytag: member="threadmanager.c::thr_mgr_downloadallchunks" ref="c9d37685f6e984d2f0c158b4dd19a759" args="(const char *resultdir, lnk *link, lnk_http_header *linkh)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thr_mgr_downloadallchunks           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>resultdir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnk.html">lnk</a> *&nbsp;</td>
          <td class="paramname"> <em>link</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlnk__http__header.html">lnk_http_header</a> *&nbsp;</td>
          <td class="paramname"> <em>linkh</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function creates chunks due to link-&gt;chunknum parameter and creates one thread for every chunk and downloads the whole file into resultdir. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>0 on success, -1 on fail. </dd></dl>

<p>Definition at line <a class="el" href="threadmanager_8c-source.html#l00160">160</a> of file <a class="el" href="threadmanager_8c-source.html">threadmanager.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="871df79560ca54f788bfca453e5ecaef"></a><!-- doxytag: member="threadmanager.c::thr_mgr_downloadallfiles" ref="871df79560ca54f788bfca453e5ecaef" args="(prgstx *stx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void thr_mgr_downloadallfiles           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structprgstx.html">prgstx</a> *&nbsp;</td>
          <td class="paramname"> <em>stx</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Downloads all links specified in <a class="el" href="structprgstx.html">prgstx</a> structure by creating thread for every link. 
<p>

<p>Definition at line <a class="el" href="threadmanager_8c-source.html#l00058">58</a> of file <a class="el" href="threadmanager_8c-source.html">threadmanager.c</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Feb 26 02:02:05 2009 for RDWGET by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
